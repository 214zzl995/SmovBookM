Index: app/src/main/res/layout/video_layout_subtitle.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<RelativeLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n        xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"match_parent\"\r\n        android:background=\"@android:color/black\">\r\n\r\n    <RelativeLayout\r\n            android:id=\"@+id/surface_container\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:gravity=\"center\">\r\n\r\n    </RelativeLayout>\r\n\r\n\r\n    <com.google.android.exoplayer2.ui.SubtitleView\r\n            android:id=\"@+id/sub_title_view\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"60dp\"\r\n            android:layout_alignParentBottom=\"true\"\r\n            android:layout_marginBottom=\"30dp\" />\r\n\r\n    <RelativeLayout\r\n            android:id=\"@+id/thumb\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:layout_alignParentStart=\"true\"\r\n            android:layout_alignParentTop=\"true\"\r\n            android:layout_alignParentEnd=\"true\"\r\n            android:layout_alignParentBottom=\"true\"\r\n            android:background=\"#000000\"\r\n            android:scaleType=\"fitCenter\" />\r\n\r\n    <LinearLayout\r\n            android:id=\"@+id/layout_bottom\"\r\n            android:orientation=\"vertical\"\r\n            android:layout_alignParentBottom=\"true\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            android:paddingRight=\"20dp\"\r\n            android:paddingLeft=\"20dp\"\r\n            android:gravity=\"top\"\r\n            android:visibility=\"invisible\">\r\n\r\n\r\n        <LinearLayout\r\n                android:id=\"@+id/layout_bottom_seek\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:paddingBottom=\"10dp\"\r\n                android:background=\"#00000000\"\r\n                android:gravity=\"center_vertical\"\r\n                android:orientation=\"horizontal\"\r\n                android:visibility=\"visible\">\r\n\r\n            <TextView\r\n                    android:id=\"@+id/current\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:paddingStart=\"0dp\"\r\n                    android:paddingEnd=\"0dp\"\r\n                    android:layout_marginStart=\"16dp\"\r\n                    android:text=\"@string/video_time_start\"\r\n                    android:textColor=\"#ffffff\" />\r\n\r\n            <SeekBar\r\n                    android:id=\"@+id/progress\"\r\n                    android:layout_width=\"0dp\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:layout_gravity=\"center_vertical\"\r\n                    android:layout_weight=\"1.0\"\r\n                    android:background=\"@null\"\r\n                    android:max=\"100\"\r\n                    android:maxHeight=\"4dp\"\r\n                    android:minHeight=\"4dp\"\r\n                    android:paddingTop=\"8dp\"\r\n                    android:paddingBottom=\"8dp\"\r\n                    android:progressDrawable=\"@drawable/video_seek_progress\"\r\n                    android:thumb=\"@drawable/ic_seekbar_thumb\" />\r\n\r\n            <TextView\r\n                    android:id=\"@+id/total\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:text=\"@string/video_time_start\"\r\n                    android:textColor=\"#ffffff\" />\r\n\r\n            <ImageView\r\n                    android:id=\"@+id/fullscreen\"\r\n                    android:layout_width=\"wrap_content\"\r\n                    android:layout_height=\"fill_parent\"\r\n                    android:paddingStart=\"16dp\"\r\n                    android:paddingEnd=\"16dp\"\r\n                    android:scaleType=\"center\"\r\n                    android:src=\"@drawable/ic_add_to_booksheelf\"\r\n                    app:tint=\"#FFFFFF\" />\r\n\r\n\r\n        </LinearLayout>\r\n\r\n        <LinearLayout\r\n                android:id=\"@+id/layout_bottom_function\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:paddingBottom=\"15dp\"\r\n                android:background=\"#00000000\"\r\n                android:gravity=\"center\"\r\n                android:orientation=\"horizontal\"\r\n                android:visibility=\"gone\"\r\n                android:paddingStart=\"5dp\"\r\n                android:paddingEnd=\"5dp\">\r\n\r\n\r\n            <LinearLayout\r\n                    android:id=\"@+id/speed\"\r\n                    android:orientation=\"horizontal\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:gravity=\"center\"\r\n                    android:descendantFocusability=\"blocksDescendants\"\r\n                    android:visibility=\"visible\"\r\n                    android:layout_weight=\"1\">\r\n\r\n                <ImageView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:paddingStart=\"0dp\"\r\n                        android:paddingEnd=\"5dp\"\r\n                        app:srcCompat=\"@drawable/ic_outline_browse_gallery_24\"\r\n                        android:contentDescription=\"@string/speed\" />\r\n\r\n                <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"@string/speed\"\r\n                        android:textColor=\"#ffffff\" />\r\n\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                    android:id=\"@+id/clarity\"\r\n                    android:orientation=\"horizontal\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:gravity=\"center\"\r\n                    android:descendantFocusability=\"blocksDescendants\"\r\n                    android:visibility=\"visible\"\r\n                    android:layout_weight=\"1\">\r\n\r\n                <ImageView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:paddingStart=\"0dp\"\r\n                        android:paddingEnd=\"5dp\"\r\n                        app:srcCompat=\"@drawable/ic_baseline_calendar_view_day_24\"\r\n                        android:contentDescription=\"@string/clarity\" />\r\n\r\n                <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"@string/clarity\"\r\n                        android:textColor=\"#ffffff\" />\r\n\r\n            </LinearLayout>\r\n\r\n            <LinearLayout\r\n                    android:id=\"@+id/other\"\r\n                    android:orientation=\"horizontal\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:gravity=\"center\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:descendantFocusability=\"blocksDescendants\"\r\n                    android:visibility=\"visible\"\r\n                    android:layout_weight=\"1\">\r\n\r\n                <ImageView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:paddingStart=\"0dp\"\r\n                        android:paddingEnd=\"5dp\"\r\n                        app:srcCompat=\"@drawable/ic_outline_pending_24\"\r\n                        android:contentDescription=\"@string/other\" />\r\n\r\n                <TextView\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:text=\"@string/other\"\r\n                        android:textColor=\"#ffffff\" />\r\n\r\n            </LinearLayout>\r\n\r\n\r\n        </LinearLayout>\r\n\r\n    </LinearLayout>\r\n\r\n\r\n    <ProgressBar\r\n            android:id=\"@+id/bottom_progressbar\"\r\n            style=\"?android:attr/progressBarStyleHorizontal\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"1.5dp\"\r\n            android:layout_alignParentBottom=\"true\"\r\n            android:max=\"100\"\r\n            android:progressDrawable=\"@drawable/video_progress_smovbook\" />\r\n\r\n    <ImageView\r\n            android:id=\"@+id/back_tiny\"\r\n            android:layout_width=\"24dp\"\r\n            android:layout_height=\"24dp\"\r\n            android:layout_marginStart=\"6dp\"\r\n            android:layout_marginEnd=\"6dp\"\r\n            android:layout_marginTop=\"6dp\"\r\n            android:visibility=\"gone\" />\r\n\r\n    <LinearLayout\r\n            android:id=\"@+id/layout_top\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"48dp\"\r\n            android:paddingStart=\"30dp\"\r\n            android:paddingEnd=\"20dp\"\r\n            android:background=\"@drawable/video_title_bg_smovbook\"\r\n            android:gravity=\"center_vertical\">\r\n\r\n        <ImageView\r\n                android:id=\"@+id/back\"\r\n                android:layout_width=\"48dp\"\r\n                android:layout_height=\"48dp\"\r\n                android:paddingStart=\"10dp\"\r\n                android:paddingEnd=\"10dp\"\r\n                android:scaleType=\"centerInside\"\r\n                android:src=\"@drawable/ic_round_arrow_back_ios_24\" />\r\n\r\n        <TextView\r\n                android:id=\"@+id/title\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:paddingStart=\"10dp\"\r\n                android:paddingEnd=\"10dp\"\r\n                android:textColor=\"@android:color/white\"\r\n                android:textSize=\"18sp\" />\r\n\r\n        <androidx.compose.ui.platform.ComposeView\r\n                android:id=\"@+id/compose_dialog\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"wrap_content\" />\r\n\r\n    </LinearLayout>\r\n\r\n\r\n    <ProgressBar\r\n            android:id=\"@+id/loading\"\r\n            style=\"?android:attr/progressBarStyleLarge\"\r\n            android:layout_width=\"28dp\"\r\n            android:layout_height=\"28dp\"\r\n            android:layout_centerHorizontal=\"true\"\r\n            android:layout_centerVertical=\"true\"\r\n            android:visibility=\"invisible\" />\r\n\r\n    <ImageView\r\n            android:id=\"@+id/start\"\r\n            android:layout_width=\"60dp\"\r\n            android:layout_height=\"60dp\"\r\n            android:layout_centerHorizontal=\"true\"\r\n            android:layout_centerVertical=\"true\"\r\n            android:layout_gravity=\"center_vertical\"\r\n            android:src=\"@drawable/video_click_play_selector_smovbook\" />\r\n\r\n\r\n    <ImageView\r\n            android:id=\"@+id/small_close\"\r\n            android:layout_width=\"30dp\"\r\n            android:layout_height=\"30dp\"\r\n            android:paddingStart=\"10dp\"\r\n            android:paddingEnd=\"10dp\"\r\n            android:paddingTop=\"10dp\"\r\n            android:scaleType=\"centerInside\"\r\n            android:src=\"@drawable/video_small_close\"\r\n            android:visibility=\"gone\" />\r\n\r\n    <ImageView\r\n            android:id=\"@+id/lock_screen\"\r\n            android:layout_width=\"30dp\"\r\n            android:layout_height=\"30dp\"\r\n            android:layout_alignParentEnd=\"true\"\r\n            android:layout_centerVertical=\"true\"\r\n            android:layout_marginEnd=\"50dp\"\r\n            android:scaleType=\"centerInside\"\r\n            android:src=\"@drawable/unlock\"\r\n            android:visibility=\"gone\" />\r\n\r\n    <LinearLayout\r\n            android:id=\"@+id/dialog\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:paddingStart=\"20dp\"\r\n            android:paddingEnd=\"20dp\"\r\n            android:visibility=\"gone\"\r\n            android:gravity=\"bottom|center_horizontal\">\r\n\r\n        <LinearLayout\r\n                android:id=\"@+id/clarity_dialog\"\r\n                android:layout_width=\"200dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:background=\"@drawable/shape_dialog\"\r\n                android:layout_marginBottom=\"20dp\"\r\n                android:visibility=\"gone\"\r\n                android:orientation=\"vertical\">\r\n\r\n            <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"?android:attr/selectableItemBackground\"\r\n                    android:clickable=\"true\"\r\n                    android:drawablePadding=\"16dp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:padding=\"16dp\"\r\n                    android:text=\"@string/clarity4000\"\r\n                    android:textColor=\"#FFFFFF\"\r\n                    android:textSize=\"14sp\" />\r\n\r\n            <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"?android:attr/selectableItemBackground\"\r\n                    android:clickable=\"true\"\r\n                    android:drawablePadding=\"16dp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:padding=\"16dp\"\r\n                    android:text=\"@string/clarity1080\"\r\n                    android:textColor=\"#FFFFFF\"\r\n                    android:textSize=\"14sp\" />\r\n\r\n            <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"?android:attr/selectableItemBackground\"\r\n                    android:clickable=\"true\"\r\n                    android:drawablePadding=\"16dp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:padding=\"16dp\"\r\n                    android:text=\"@string/clarity720\"\r\n                    android:textColor=\"#FFFFFF\"\r\n                    android:textSize=\"14sp\" />\r\n        </LinearLayout>\r\n\r\n        <LinearLayout\r\n                android:id=\"@+id/speed_dialog\"\r\n                android:layout_width=\"200dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:background=\"@drawable/shape_dialog\"\r\n                android:layout_marginBottom=\"20dp\"\r\n                android:visibility=\"gone\"\r\n                android:orientation=\"vertical\">\r\n\r\n            <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"?android:attr/selectableItemBackground\"\r\n                    android:clickable=\"true\"\r\n                    android:drawablePadding=\"16dp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:padding=\"16dp\"\r\n                    android:text=\"@string/speed_0_5\"\r\n                    android:textColor=\"#FFFFFF\"\r\n                    android:textSize=\"14sp\" />\r\n\r\n            <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"?android:attr/selectableItemBackground\"\r\n                    android:clickable=\"true\"\r\n                    android:drawablePadding=\"16dp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:padding=\"16dp\"\r\n                    android:text=\"@string/speed_0_75\"\r\n                    android:textColor=\"#FFFFFF\"\r\n                    android:textSize=\"14sp\" />\r\n\r\n            <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"?android:attr/selectableItemBackground\"\r\n                    android:clickable=\"true\"\r\n                    android:drawablePadding=\"16dp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:padding=\"16dp\"\r\n                    android:text=\"@string/speed_1_0\"\r\n                    android:textColor=\"#FFFFFF\"\r\n                    android:textSize=\"14sp\" />\r\n\r\n            <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"?android:attr/selectableItemBackground\"\r\n                    android:clickable=\"true\"\r\n                    android:drawablePadding=\"16dp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:padding=\"16dp\"\r\n                    android:text=\"@string/speed_2_0\"\r\n                    android:textColor=\"#FFFFFF\"\r\n                    android:textSize=\"14sp\" />\r\n\r\n            <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"?android:attr/selectableItemBackground\"\r\n                    android:clickable=\"true\"\r\n                    android:drawablePadding=\"16dp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:padding=\"16dp\"\r\n                    android:text=\"@string/speed_4_0\"\r\n                    android:textColor=\"#FFFFFF\"\r\n                    android:textSize=\"14sp\" />\r\n        </LinearLayout>\r\n\r\n        <LinearLayout\r\n                android:id=\"@+id/other_dialog\"\r\n                android:layout_width=\"200dp\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginBottom=\"20dp\"\r\n                android:background=\"@drawable/shape_dialog\"\r\n                android:visibility=\"gone\"\r\n                android:orientation=\"vertical\">\r\n\r\n            <TextView\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"wrap_content\"\r\n                    android:background=\"?android:attr/selectableItemBackground\"\r\n                    android:clickable=\"true\"\r\n                    android:drawablePadding=\"16dp\"\r\n                    android:gravity=\"center_vertical\"\r\n                    android:padding=\"16dp\"\r\n                    android:text=\"@string/other_nothing\"\r\n                    android:textColor=\"#FFFFFF\"\r\n                    android:textSize=\"14sp\" />\r\n\r\n\r\n        </LinearLayout>\r\n\r\n    </LinearLayout>\r\n\r\n\r\n</RelativeLayout>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/video_layout_subtitle.xml b/app/src/main/res/layout/video_layout_subtitle.xml
--- a/app/src/main/res/layout/video_layout_subtitle.xml	(revision c41ede62a01f7c2eab14a3431805a920f14ce2a6)
+++ b/app/src/main/res/layout/video_layout_subtitle.xml	(date 1673793200042)
@@ -267,6 +267,14 @@
             android:layout_gravity="center_vertical"
             android:src="@drawable/video_click_play_selector_smovbook" />
 
+    <androidx.compose.ui.platform.ComposeView
+            android:id="@+id/compose_start"
+            android:layout_width="60dp"
+            android:layout_height="60dp"
+            android:layout_centerHorizontal="true"
+            android:layout_centerVertical="true"
+            android:layout_gravity="center_vertical" />
+
 
     <ImageView
             android:id="@+id/small_close"
Index: app/src/main/java/com/leri/smovbook/ui/player/SmovVideoView.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.leri.smovbook.ui.player\r\n\r\nimport android.animation.AnimatorInflater\r\nimport android.app.Activity\r\nimport android.content.Context\r\nimport android.graphics.*\r\nimport android.media.AudioManager\r\nimport android.util.AttributeSet\r\nimport android.util.TypedValue\r\nimport android.view.View\r\nimport android.view.ViewGroup\r\nimport android.view.WindowManager\r\nimport android.widget.ImageView\r\nimport androidx.compose.ui.platform.ComposeView\r\nimport androidx.core.animation.addListener\r\nimport coil.load\r\nimport com.google.android.exoplayer2.Player\r\nimport com.google.android.exoplayer2.SeekParameters\r\nimport com.google.android.exoplayer2.text.CueGroup\r\nimport com.google.android.exoplayer2.ui.CaptionStyleCompat\r\nimport com.google.android.exoplayer2.ui.SubtitleView\r\nimport com.leri.smovbook.R\r\nimport com.leri.smovbook.ui.player.exosubtitle.GSYExoSubTitlePlayerManager\r\nimport com.leri.smovbook.ui.player.exosubtitle.GSYExoSubTitleVideoManager\r\nimport com.leri.smovbook.ui.player.utils.OrientationUtils\r\nimport com.leri.smovbook.ui.smovDetail.getActivity\r\nimport com.leri.smovbook.ui.theme.SmovBookMTheme\r\nimport com.shuyu.gsyvideoplayer.builder.GSYVideoOptionBuilder\r\nimport com.shuyu.gsyvideoplayer.listener.VideoAllCallBack\r\nimport com.shuyu.gsyvideoplayer.utils.Debuger\r\nimport com.shuyu.gsyvideoplayer.video.NormalGSYVideoPlayer\r\nimport com.shuyu.gsyvideoplayer.video.base.GSYBaseVideoPlayer\r\nimport com.shuyu.gsyvideoplayer.video.base.GSYVideoPlayer\r\nimport tv.danmaku.ijk.media.exo2.Exo2PlayerManager\r\n\r\n\r\nclass SmovVideoView : NormalGSYVideoPlayer, Player.Listener,\r\n    View.OnClickListener, VideoAllCallBack {\r\n\r\n    private lateinit var mSubtitleView: SubtitleView\r\n    var subTitle: String? = null\r\n    lateinit var orientationUtils: OrientationUtils\r\n\r\n    private var sTitle: String = \"\"\r\n    private var sUrl: String = \"\"\r\n    private var sCover: String = \"\"\r\n\r\n    val title: String get() = sTitle\r\n    val url: String get() = sUrl\r\n\r\n    private var gsyVideoOption = GSYVideoOptionBuilder()\r\n\r\n    private lateinit var mBottomFunction: ViewGroup\r\n\r\n    private lateinit var mDialog: ViewGroup\r\n\r\n    private lateinit var mClarityDialog: ViewGroup\r\n\r\n    private lateinit var mClarityButton: ViewGroup\r\n\r\n    private lateinit var mSpeedDialog: ViewGroup\r\n\r\n    private lateinit var mSpeedButton: ViewGroup\r\n\r\n    private lateinit var mOtherButton: ViewGroup\r\n\r\n    private lateinit var mOtherDialog: ViewGroup\r\n\r\n    fun smovInit(title: String, url: String, subTitle: String?, cover: String) {\r\n        this.sTitle = title\r\n        this.sUrl = url\r\n        this.subTitle = subTitle\r\n        this.sCover = cover\r\n\r\n\r\n        //增加封面\r\n        val imageView = ImageView(context)\r\n        imageView.scaleType = ImageView.ScaleType.CENTER_CROP\r\n        imageView.load(cover) {\r\n            crossfade(true)\r\n            error(R.drawable.ic_error)\r\n        }\r\n\r\n        mTitleTextView.visibility = GONE\r\n        mBackButton.visibility = GONE\r\n        orientationUtils.isEnable = false\r\n        gsyVideoOption\r\n            .setThumbImageView(imageView)\r\n            .setIsTouchWiget(false)\r\n            .setRotateViewAuto(false)\r\n            .setLockLand(false)\r\n            .setAutoFullWithSize(false)\r\n            .setShowFullAnimation(false)\r\n            .setNeedLockFull(true)\r\n            .setUrl(sUrl)\r\n            .setSeekRatio(2.5f)\r\n            .setCacheWithPlay(false)\r\n            .setVideoAllCallBack(this)\r\n            .setVideoTitle(sTitle).setLockClickListener { _, lock ->\r\n                orientationUtils.isEnable = !lock\r\n            }\r\n            .setEnlargeImageRes(R.drawable.ic_add_to_booksheelf)\r\n            .setShrinkImageRes(R.drawable.ic_add_to_booksheelf)\r\n            .setGSYVideoProgressListener { progress, secProgress, currentPosition, duration ->\r\n                Debuger.printfLog(\r\n                    \" progress $progress secProgress $secProgress currentPosition $currentPosition duration $duration\"\r\n                )\r\n            }\r\n            .build(this)\r\n    }\r\n\r\n\r\n    constructor(context: Context?) : super(context) {\r\n        this.orientationUtils = context!!.getActivity()?.let { OrientationUtils(it, this) }!!\r\n    }\r\n\r\n    constructor(context: Context?, attrs: AttributeSet?) : super(context, attrs) {}\r\n\r\n    constructor(context: Context?, title: String, url: String, subTitle: String?) : super(context) {\r\n        this.sTitle = title\r\n        this.sUrl = url\r\n        this.subTitle = subTitle\r\n        this.orientationUtils = context!!.getActivity()?.let { OrientationUtils(it, this) }!!\r\n    }\r\n\r\n    fun setSubtitleViewTextSize(size: Float) {\r\n        mSubtitleView.setFixedTextSize(TypedValue.COMPLEX_UNIT_DIP, size)\r\n    }\r\n\r\n    override fun init(context: Context) {\r\n        super.init(context)\r\n        fullscreenButton.setOnClickListener(this)\r\n\r\n        mSubtitleView = findViewById(R.id.sub_title_view)\r\n        mSubtitleView.setStyle(\r\n            CaptionStyleCompat(\r\n                Color.WHITE,\r\n                Color.TRANSPARENT,\r\n                Color.TRANSPARENT,\r\n                CaptionStyleCompat.EDGE_TYPE_NONE,\r\n                CaptionStyleCompat.EDGE_TYPE_NONE,\r\n                null\r\n            )\r\n        )\r\n\r\n        setSubtitleViewTextSize(14F)\r\n\r\n        mBottomFunction = findViewById(R.id.layout_bottom_function)\r\n        mDialog = findViewById(R.id.dialog)\r\n\r\n        mClarityDialog = findViewById(R.id.clarity_dialog)\r\n        mClarityButton = findViewById(R.id.clarity)\r\n        mSpeedButton = findViewById(R.id.speed)\r\n        mSpeedDialog = findViewById(R.id.speed_dialog)\r\n        mOtherButton = findViewById(R.id.other)\r\n        mOtherDialog = findViewById(R.id.other_dialog)\r\n\r\n        mDialog.setOnClickListener(this)\r\n        mSpeedButton.setOnClickListener(this)\r\n        mClarityButton.setOnClickListener(this)\r\n        mOtherButton.setOnClickListener(this)\r\n\r\n        mBottomContainer.setPadding(5, 0, 20, 0)\r\n\r\n        val greeting = findViewById<ComposeView>(R.id.compose_dialog)\r\n\r\n        //Compose嵌入View 但是无法控制它是否显示 优先以View完成这个功能\r\n        greeting.setContent {\r\n            SmovBookMTheme {\r\n                ComposeDialog()\r\n            }\r\n        }\r\n    }\r\n\r\n    override fun getLayoutId(): Int {\r\n        return R.layout.video_layout_subtitle\r\n    }\r\n\r\n    override fun updateStartImage() {\r\n        if (mStartButton is ImageView) {\r\n            val imageView = mStartButton as ImageView\r\n            when (mCurrentState) {\r\n                CURRENT_STATE_PLAYING -> {\r\n                    imageView.setImageResource(R.drawable.video_click_pause_selector_smovbook)\r\n                }\r\n                CURRENT_STATE_ERROR -> {\r\n                    imageView.setImageResource(R.drawable.video_click_play_selector_smovbook)\r\n                }\r\n                else -> {\r\n                    imageView.setImageResource(R.drawable.video_click_play_selector_smovbook)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    override fun startPrepare() {\r\n\r\n        if (gsyVideoManager.listener() != null) {\r\n            gsyVideoManager.listener().onCompletion()\r\n        }\r\n        if (mVideoAllCallBack != null) {\r\n            Debuger.printfLog(\"onStartPrepared\")\r\n            mVideoAllCallBack.onStartPrepared(mOriginUrl, mTitle, this)\r\n        }\r\n        gsyVideoManager.setListener(this)\r\n        gsyVideoManager.playTag = mPlayTag\r\n        gsyVideoManager.playPosition = mPlayPosition\r\n        mAudioManager.requestAudioFocus(\r\n            onAudioFocusChangeListener,\r\n            AudioManager.STREAM_MUSIC,\r\n            AudioManager.AUDIOFOCUS_GAIN_TRANSIENT\r\n        )\r\n        try {\r\n            if (mContext is Activity) {\r\n                (mContext as Activity).window.addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON)\r\n            }\r\n        } catch (e: Exception) {\r\n            e.printStackTrace()\r\n        }\r\n\r\n        mBackUpPlayingBufferState = -1\r\n        gsyVideoManager.prepare(\r\n            mUrl,\r\n            subTitle,\r\n            this,\r\n            if (mMapHeadData == null) HashMap() else mMapHeadData,\r\n            mLooping,\r\n            mSpeed,\r\n            mCache,\r\n            mCachePath,\r\n            mOverrideExtension\r\n        )\r\n        setStateAndUi(CURRENT_STATE_PREPAREING)\r\n    }\r\n\r\n    override fun onClick(v: View) {\r\n        when (v.id) {\r\n            R.id.fullscreen -> {\r\n                /**\r\n                 * 确定出现错误的位置\r\n                 * orientationUtils.resolveByClick() 没有成功的把屏幕旋转过来\r\n                 */\r\n                orientationUtils.resolveByClick()\r\n                startWindowFullscreen(context, actionBar = true, statusBar = true)\r\n            }\r\n            R.id.clarity -> {\r\n                showDialog(mClarityDialog)\r\n                //查看 GSYVideoControlView 1097行 1026行 829行 需要添加状态 设置页出现 重写 resolveUIState\r\n                resolveUIState(CURRENT_STATE_PAUSE)\r\n            }\r\n            R.id.other -> {\r\n                showDialog(mOtherDialog)\r\n                resolveUIState(CURRENT_STATE_PAUSE)\r\n            }\r\n            R.id.speed -> {\r\n                showDialog(mSpeedDialog)\r\n                resolveUIState(CURRENT_STATE_PAUSE)\r\n            }\r\n            R.id.dialog -> {\r\n                disableDialog(getShowDialog())\r\n                resolveUIState(CURRENT_STATE_PLAYING)\r\n            }\r\n        }\r\n\r\n        super.onClick(v)\r\n    }\r\n\r\n    /**\r\n     * 显示对话弹出框后 控件一直存在\r\n     */\r\n    private fun showDialog(v: ViewGroup) {\r\n        mDialog.visibility = VISIBLE\r\n        v.visibility = VISIBLE\r\n        val animator = AnimatorInflater.loadAnimator(context, R.animator.dialog_in)\r\n        animator.setTarget(v)\r\n        animator.start()\r\n    }\r\n\r\n    /**\r\n     * 显示对话弹出框后 控件消失\r\n     */\r\n    private fun disableDialog(v: ViewGroup) {\r\n        val animator = AnimatorInflater.loadAnimator(context, R.animator.dialog_out)\r\n        animator.addListener(onEnd = {\r\n            v.visibility = GONE\r\n            mDialog.visibility = GONE\r\n        })\r\n        animator.setTarget(v)\r\n        animator.start()\r\n    }\r\n\r\n    private fun getShowDialog(): ViewGroup {\r\n        return if (mOtherDialog.visibility == VISIBLE) {\r\n            mOtherDialog\r\n        } else if (mSpeedDialog.visibility == VISIBLE) {\r\n            mSpeedDialog\r\n        } else {\r\n            mClarityDialog\r\n        }\r\n    }\r\n\r\n\r\n    override fun onCues(cueGroup: CueGroup) {\r\n        mSubtitleView.setCues(cueGroup.cues)\r\n    }\r\n\r\n    /**********以下重载 GSYVideoPlayer 的 全屏 SubtitleView 相关实现 */\r\n    override fun startWindowFullscreen(\r\n        context: Context,\r\n        actionBar: Boolean,\r\n        statusBar: Boolean\r\n    ): GSYBaseVideoPlayer {\r\n        val gsyBaseVideoPlayer = super.startWindowFullscreen(context, actionBar, statusBar)\r\n        val gsyExoSubTitleVideoView = gsyBaseVideoPlayer as SmovVideoView\r\n\r\n        (GSYExoSubTitleVideoManager.instance().player as GSYExoSubTitlePlayerManager).addTextOutputPlaying(gsyExoSubTitleVideoView)\r\n\r\n        gsyBaseVideoPlayer.setSubtitleViewTextSize(24f)\r\n\r\n        gsyBaseVideoPlayer.mBottomFunction.visibility = VISIBLE\r\n        gsyBaseVideoPlayer.mBottomContainer.setPadding(20, 0, 10, 0)\r\n        return gsyBaseVideoPlayer\r\n    }\r\n\r\n    override fun resolveNormalVideoShow(oldF: View, vp: ViewGroup, gsyVideoPlayer: GSYVideoPlayer) {\r\n        super.resolveNormalVideoShow(oldF, vp, gsyVideoPlayer)\r\n\r\n        val gsyExoSubTitleVideoView = gsyVideoPlayer as SmovVideoView\r\n        (GSYExoSubTitleVideoManager.instance().player as GSYExoSubTitlePlayerManager).removeTextOutput(\r\n            gsyExoSubTitleVideoView\r\n        )\r\n\r\n        gsyExoSubTitleVideoView.setSubtitleViewTextSize(14f)\r\n\r\n        //加了这个横竖屏旋转正常了。。。\r\n        orientationUtils.resolveByClick()\r\n        gsyExoSubTitleVideoView.mBottomFunction.visibility = GONE\r\n        gsyExoSubTitleVideoView.mBottomContainer.setPadding(5, 0, 5, 0)\r\n    }\r\n\r\n    /**********以下重载GSYVideoPlayer的GSYVideoViewBridge相关实现 */\r\n    override fun getGSYVideoManager(): GSYExoSubTitleVideoManager {\r\n        GSYExoSubTitleVideoManager.instance().initContext(context.applicationContext)\r\n        return GSYExoSubTitleVideoManager.instance()\r\n    }\r\n\r\n    override fun backFromFull(context: Context): Boolean {\r\n        return GSYExoSubTitleVideoManager.backFromWindowFull(context)\r\n    }\r\n\r\n    override fun releaseVideos() {\r\n        GSYExoSubTitleVideoManager.releaseAllVideos()\r\n    }\r\n\r\n    override fun getFullId(): Int {\r\n        return GSYExoSubTitleVideoManager.FULLSCREEN_ID\r\n    }\r\n\r\n    override fun getSmallId(): Int {\r\n        return GSYExoSubTitleVideoManager.SMALL_ID\r\n    }\r\n\r\n    override fun onStartPrepared(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onPrepared(url: String, vararg objects: Any) {\r\n        Debuger.printfError(\"***** onPrepared **** \" + objects[0])\r\n        Debuger.printfError(\"***** onPrepared **** \" + objects[1])\r\n\r\n        orientationUtils.isEnable = isRotateWithSystem\r\n\r\n        //外部辅助的旋转，帮助全屏\r\n        if (gsyVideoManager.player is Exo2PlayerManager) {\r\n            (gsyVideoManager.player as Exo2PlayerManager).setSeekParameter(\r\n                SeekParameters.NEXT_SYNC\r\n            )\r\n            Debuger.printfError(\"***** setSeekParameter **** \")\r\n        }\r\n    }\r\n\r\n    override fun onClickStartIcon(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onClickStartError(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onClickStop(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onClickStopFullscreen(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onClickResume(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onClickResumeFullscreen(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onClickSeekbar(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onClickSeekbarFullscreen(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onAutoComplete(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onComplete(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onEnterFullscreen(url: String, vararg objects: Any) {\r\n        println(\"进入全屏\")\r\n        Debuger.printfError(\"***** onEnterFullscreen **** \" + objects[0]) //title\r\n        Debuger.printfError(\"***** onEnterFullscreen **** \" + objects[1]) //当前全屏player\r\n    }\r\n\r\n    override fun onQuitFullscreen(url: String?, vararg objects: Any?) {\r\n        println(\"退出全屏\")\r\n    }\r\n\r\n    override fun onQuitSmallWidget(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onEnterSmallWidget(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onTouchScreenSeekVolume(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onTouchScreenSeekPosition(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onTouchScreenSeekLight(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onPlayError(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onClickStartThumb(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onClickBlank(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n\r\n    override fun onClickBlankFullscreen(url: String?, vararg objects: Any?) {\r\n\r\n    }\r\n}\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/leri/smovbook/ui/player/SmovVideoView.kt b/app/src/main/java/com/leri/smovbook/ui/player/SmovVideoView.kt
--- a/app/src/main/java/com/leri/smovbook/ui/player/SmovVideoView.kt	(revision c41ede62a01f7c2eab14a3431805a920f14ce2a6)
+++ b/app/src/main/java/com/leri/smovbook/ui/player/SmovVideoView.kt	(date 1673793200064)
@@ -170,6 +170,14 @@
                 ComposeDialog()
             }
         }
+
+        val composeStart = findViewById<ComposeView>(R.id.compose_start)
+
+        composeStart.setContent {
+            SmovBookMTheme {
+
+            }
+        }
     }
 
     override fun getLayoutId(): Int {
Index: app/src/main/java/com/leri/smovbook/ui/player/composeStart.kt
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/leri/smovbook/ui/player/composeStart.kt b/app/src/main/java/com/leri/smovbook/ui/player/composeStart.kt
new file mode 100644
--- /dev/null	(date 1673793200054)
+++ b/app/src/main/java/com/leri/smovbook/ui/player/composeStart.kt	(date 1673793200054)
@@ -0,0 +1,32 @@
+package com.leri.smovbook.ui.player
+
+import androidx.compose.foundation.layout.Box
+import androidx.compose.foundation.layout.fillMaxSize
+import androidx.compose.foundation.layout.wrapContentSize
+import androidx.compose.runtime.Composable
+import androidx.compose.runtime.getValue
+import androidx.compose.ui.Alignment
+import androidx.compose.ui.Modifier
+import com.airbnb.lottie.compose.*
+import com.leri.smovbook.R
+
+@Composable
+fun ComposeStart(
+    state: Int,
+) {
+    val composition by rememberLottieComposition(LottieCompositionSpec.RawRes(R.raw.empty_box))
+
+    val progress by animateLottieCompositionAsState(
+        composition = composition,
+        iterations = LottieConstants.IterateForever
+    )
+
+    Box(
+        modifier = Modifier
+            .fillMaxSize()
+            .wrapContentSize(Alignment.Center)
+    ) {
+        LottieAnimation(composition = composition, progress = { progress })
+    }
+
+}
\ No newline at end of file
